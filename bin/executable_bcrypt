#!/bin/bash
# Hash a password with bcrypt

######################
# Standard Library and conf
######################
# The log and error handling
# We still need to use the set command
# because shellcheck does not see them and want use to add
# exit check everywhere
set -Eeuo pipefail
# echo and error_handling should be in your bashrc.d directory


######################
# Main
######################

if [ ! -x "$(command -v htpasswd)" ]; then
  echo "htpasswd is not installed"
  echo "Install htpasswd with: sudo apt install apache2-utils"
  exit 1
fi

# Hash a password with bcrypt algorithm though htpasswd
USER=""
PASSWORD=$1
htpasswd -bnBC 10 "$USER" "$PASSWORD" | tr -d ':\n'
# where
# B force to use bcrypt,
# C set the computing time used for the bcrypt algorithm
# b Use the password from the command line rather than prompting for it.
# n Don't update file; display results on stdout.


