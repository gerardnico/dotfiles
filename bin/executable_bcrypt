#!/bin/bash
# Hash a password with bcrypt

set -Eeuo pipefail
source bashlib-error.sh
error::set_trap



######################
# Main
######################

if [ ! -x "$(command -v htpasswd)" ]; then
  echo "htpasswd is not installed"
  echo "Install htpasswd with: sudo apt install apache2-utils"
  exit 1
fi

# Hash a password with bcrypt algorithm though htpasswd
USER=""
PASSWORD=$1
htpasswd -bnBC 10 "$USER" "$PASSWORD" | tr -d ':\n'
# where
# B force to use bcrypt,
# C set the computing time used for the bcrypt algorithm
# b Use the password from the command line rather than prompting for it.
# n Don't update file; display results on stdout.


